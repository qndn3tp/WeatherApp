# 이 워크플로우의 이름
name: Weather App Build

# 언제 실행할지 정하기
on:
  push:
    branches: [ main ]

# 할 일들
jobs:
  build:
    # 🚨 수정된 부분: Xcode 16.0이 설치된 macos-14 러너를 사용하도록 변경
    runs-on: macos-14 
    
    steps:
    # 1단계: 코드 다운로드
    - name: 📥 코드 다운로드하기
      uses: actions/checkout@v4

    # 2단계: Xcode 16.x 버전 사용 설정
    - name: ⚙️ Xcode 16.0 사용      
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: '16.0'

    # 3단계: Podfile이 있을 경우 의존성 설치
    - name: 📦 의존성 확인 및 설치
      run: |
        if [ -f "Podfile" ]; then
          echo "Podfile 발견! CocoaPods 설치 중..."
          sudo gem install cocoapods
          pod install
        else
          echo "Podfile 없음 - 순수 iOS 프로젝트입니다 ✅"
        fi

    # 4단계: 빌드
    - name: 🔨 Weather 앱 빌드하기      
      run: |
        echo "=== ⚡ Weather 앱 빌드 시작! ==="
        echo "사용 가능한 시뮬레이터 확인 중..."
        xcrun simctl list devices available
        echo ""
        echo "Weather 앱 빌드 중..."
        xcodebuild build           -project Weather.xcodeproj           -scheme Weather           -destination "generic/platform=iOS Simulator"           -configuration Debug           CODE_SIGN_IDENTITY=""           CODE_SIGNING_REQUIRED=NO           ONLY_ACTIVE_ARCH=YES
        
    # 5단계: 성공 메시지
    - name: 🎉 빌드 완료!
      run: |
        echo "🎉🎉🎉 축하합니다! 🎉🎉🎉"
        echo "✅ Weather 앱 빌드가 성공했습니다!"